(this["webpackJsonpemphasoft-test"]=this["webpackJsonpemphasoft-test"]||[]).push([[0],{29:function(e,t,a){},39:function(e,t,a){},40:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(19),c=a.n(r),o=a(11),i=a(7),u=a(8),l=a.n(u),d=a(12),m=a(4),j=a(2),h=a(20),b=a(21),f=new(function(){function e(t,a){Object(h.a)(this,e),this._baseUrl=t,this._id=a}return Object(b.a)(e,[{key:"_getResponseData",value:function(e){return this._res=e,this._res.ok?this._res.json():Promise.reject(this._res)}},{key:"signInUser",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._baseUrl,"/api-token-auth/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return a=e.sent,e.abrupt("return",this._getResponseData(a));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkAndGet",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this._baseUrl,"/api/v1/users/"),{method:"GET",headers:{"Content-Type":"application/json",authorization:"Token ".concat(t)}});case 2:return a=e.sent,e.abrupt("return",this._getResponseData(a));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}())("http://emphasoft-test-assignment.herokuapp.com"),p=a(22),g=(a(29),a(0)),_=function(){return Object(g.jsx)("div",{className:"preloader",children:Object(g.jsx)("div",{className:"preloader__container",children:Object(g.jsx)("span",{className:"preloader__round"})})})},O=["component"],x=function(e){var t=e.component,a=Object(p.a)(e,O);return Object(g.jsx)(j.b,{children:function(){return a.isChecking?Object(g.jsx)(_,{}):a.isLoggedIn?Object(g.jsx)(t,Object(i.a)({},a)):Object(g.jsx)(j.a,{to:"/signin"})}})},v=a.p+"static/media/logo.48badda0.svg";a(39);var S=function(e){var t=e.onSignOut;return Object(g.jsxs)("header",{className:"header",children:[Object(g.jsx)(o.b,{className:"header__logo-link",to:"/",children:Object(g.jsx)("img",{className:"header__logo",src:v,alt:"Emphasoft Logo"})}),Object(g.jsx)("button",{"aria-label":"Sign Out",className:"header__signout-button",type:"button",onClick:t,children:"Sign Out"})]})};var N=function(e,t,a){var n=[];return n=t?e.filter((function(e){var a=e.username,n=e.firstName,s=void 0===n?e.first_name:n,r=e.lastName,c=void 0===r?e.last_name:r;return-1!==String(a).toLowerCase().indexOf(t.toLowerCase())||-1!==String(s).toLowerCase().indexOf(t.toLowerCase())||-1!==String(c).toLowerCase().indexOf(t.toLowerCase())})):e,a?n.filter((function(e){return e.is_active})):n},k=a(14);var y=function(){var e=Object(n.useState)({}),t=Object(m.a)(e,2),a=t[0],s=t[1],r=Object(n.useState)({}),c=Object(m.a)(r,2),o=c[0],u=c[1],l=Object(n.useState)(!1),d=Object(m.a)(l,2),j=d[0],h=d[1];return{handleChange:function(e){var t=e.target,n=t.name,r=t.value,c=t.validationMessage;s(Object(i.a)(Object(i.a)({},a),{},Object(k.a)({},n,r))),u(Object(i.a)(Object(i.a)({},o),{},Object(k.a)({},n,c)))},validateForm:function(e){var t=e.target.form;h(t.checkValidity())},setValues:s,setFormValidity:h,reset:function(){s({}),u({}),h({})},values:a,errors:o,formValidity:j}};a(40);var w=function(e){var t=e.checkBoxState,a=e.onCheck,n=e.onSubmit,r=e.onReset,c=y(),o=c.handleChange,i=c.validateForm,u=c.setValues,l=c.setFormValidity,d=c.reset,m=c.values,j=c.errors,h=c.formValidity;return s.a.useEffect((function(){var e=localStorage.getItem("searchKey");e&&(u({key:e}),l(!0))}),[l]),Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("div",{className:"search-form",children:[Object(g.jsxs)("div",{className:"search-form__input-container",children:[Object(g.jsxs)("form",{className:"search-form__form",id:"search-form",onChange:i,onSubmit:function(e){e.preventDefault(),n(m.key,d)},children:[Object(g.jsx)("input",{id:"user",name:"key",type:"text",value:m.key||"",onChange:o,className:"search-form__input",placeholder:"User",minLength:"2",required:!0}),h&&Object(g.jsx)("button",{type:"button","aria-label":"Reset",className:"search-form__reset",onClick:function(e){e.preventDefault(),r(),d()}}),Object(g.jsx)("button",{className:"search-form__button ".concat(h?"":"search-form__button_disabled"),type:"submit","aria-label":"Search",disabled:!h})]}),j.key&&Object(g.jsx)("span",{className:"search-form__input-error",children:j.key})]}),Object(g.jsxs)("label",{className:"search-form__filter",htmlFor:"filter",children:["Only Active",Object(g.jsx)("input",{id:"filter",type:"checkbox",className:"search-form__filter-checkbox",checked:t,onChange:a})]})]})})};var C=function(e){return new Date(Date.parse(e)).toLocaleString("ru-RU")};a(41);var L=function(e){var t=e.user;return Object(g.jsxs)("div",{className:"user-card",children:[Object(g.jsxs)("div",{className:"user-card__heading",children:[Object(g.jsx)("div",{className:"user-card__user-status ".concat(t.is_active&&"user-card__user-status_active")}),Object(g.jsx)("h2",{className:"user-card__username",children:t.username}),Object(g.jsx)("p",{className:"user-card__fullname",children:"".concat(t.first_name?t.first_name:""," ").concat(t.last_name?t.last_name:"")})]}),Object(g.jsxs)("div",{className:"user-card__info",children:[Object(g.jsx)("p",{className:"user-card__user-id",children:t.id}),t.last_login&&Object(g.jsx)("p",{className:"user-card__last-login",children:C(t.last_login)})]})]})};a(42);var I=function(e){var t=e.users,a=s.a.useState(""),n=Object(m.a)(a,2),r=n[0],c=n[1],o=s.a.useState(!1),i=Object(m.a)(o,2),u=i[0],l=i[1],d=s.a.useState([]),j=Object(m.a)(d,2),h=j[0],b=j[1],f=s.a.useState(!1),p=Object(m.a)(f,2),_=p[0],O=p[1];return s.a.useEffect((function(){l("true"===localStorage.getItem("activeUsersOnly")),c(localStorage.getItem("searchKey"))}),[r,u]),s.a.useEffect((function(){var e=N(t,r,u);e.length?O(!1):O(!0),b(e)}),[r,u]),Object(g.jsxs)("section",{className:"users-list",children:[Object(g.jsx)("h1",{className:"users-list__title",children:"Users List"}),Object(g.jsx)(w,{checkBoxState:u,onCheck:function(e){l(e.target.checked),localStorage.setItem("activeUsersOnly",e.target.checked)},onSubmit:function(e){c(e),localStorage.setItem("searchKey",e)},onReset:function(){c(null),O(!1),localStorage.removeItem("searchKey")}}),_?Object(g.jsx)("p",{className:"users-list__message",children:"Nothing Found"}):Object(g.jsx)("div",{className:"users-list__grid",children:h.sort((function(e,t){return e.id-t.id})).map((function(e){return Object(g.jsx)(L,{user:e},e.id)}))})]})};a(43);var F=function(){return Object(g.jsx)("footer",{className:"footer",children:Object(g.jsx)("p",{className:"footer__copyright",children:"\xa9 Khizri Makhmudov for Emphasoft"})})};var D=function(e){var t=e.isLoggedIn,a=e.onSignOut,n=e.users;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(S,{isLoggedIn:t,onSignOut:a}),Object(g.jsx)(I,{users:n}),Object(g.jsx)(F,{})]})};a(44);var T=function(e){var t=e.isShown,a=e.code,n=e.type,r=s.a.useState(""),c=Object(m.a)(r,2),o=c[0],i=c[1];return s.a.useEffect((function(){var e;200!==a&&201!==a||i("Data updated"),a>=400&&i("signup"===(e=n)?"An error occurred on sign up":"signin"===e?"Wrong username or password":"update"===e?"An error occurred on profile update":"An error occurred")}),[a,n]),Object(g.jsx)("div",{className:"message",children:t&&Object(g.jsx)("p",{className:"message__text ".concat(a>=400?"message__text_error":""),children:o})})};a(45);var U=function(e){var t=e.title,a=e.buttonText,n=e.captionText,s=e.children,r=e.isValid,c=e.validate,u=e.onSubmit,l=e.infoMessage;return Object(g.jsxs)("div",{className:"form-page",children:[Object(g.jsx)(o.b,{className:"form-page__logo-link",to:"/",children:Object(g.jsx)("img",{className:"form-page__logo",src:v,alt:"Emphasoft Logo"})}),Object(g.jsx)("h1",{className:"form-page__title",children:t}),Object(g.jsx)("form",{className:"form-page__form",id:"form-page",autoComplete:"on",onChange:c,onSubmit:u,noValidate:!0,children:s}),Object(g.jsx)(T,Object(i.a)({},l)),Object(g.jsx)("button",{form:"form-page",className:"form-page__button ".concat(r?"":"form-page__button_disabled"),type:"submit",disabled:!r,children:a}),Object(g.jsx)("div",{className:"form-page__caption",children:Object(g.jsx)("p",{className:"form-page__caption-text",children:n})})]})};a(46);var V=function(e){var t=e.isSubmitting,a=e.buttonState,n=e.infoMessage,s=e.onSubmit,r=y(),c=r.handleChange,o=r.validateForm,i=r.values,u=r.errors,l=r.formValidity,d=i.username,m=i.password;return Object(g.jsx)("div",{className:"login",children:Object(g.jsx)(U,{title:"Hello!",buttonText:a||"Sign In",captionText:"Don't have an account? Please contact the administrator",isValid:l,validate:o,onSubmit:function(e){e.preventDefault(),s(d,m)},infoMessage:n,children:Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("label",{htmlFor:"username",className:"form-page__label",children:["Username",Object(g.jsx)("input",{id:"username",name:"username",type:"text",onChange:c,className:"form-page__input ".concat(u.username?"form-page__input_type_error":""),placeholder:"your_user_name",pattern:"^[\\w.@+-]+$",autoComplete:"username",minLength:"1",disabled:t,required:!0}),u.username&&Object(g.jsx)("span",{className:"form-page__input-error",children:u.username})]}),Object(g.jsxs)("label",{htmlFor:"password",className:"form-page__label",children:["Password",Object(g.jsx)("input",{id:"user-password",name:"password",type:"password",onChange:c,className:"form-page__input ".concat(u.password?"form-page__input_type_error":""),autoComplete:"current-password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",minLength:"8",disabled:t,required:!0}),u.password&&Object(g.jsx)("span",{className:"form-page__input-error",children:u.password})]})]})})})};a(47);var E=function(){var e=Object(j.g)(),t=s.a.useState([]),a=Object(m.a)(t,2),n=a[0],r=a[1],c=s.a.useState(!1),o=Object(m.a)(c,2),u=o[0],h=o[1],b=s.a.useState(!0),p=Object(m.a)(b,2),_=p[0],O=p[1],v=s.a.useState(!1),S=Object(m.a)(v,2),N=S[0],k=S[1],y=s.a.useState(""),w=Object(m.a)(y,2),C=w[0],L=w[1],I=s.a.useState({isShown:!1,type:"",code:200}),F=Object(m.a)(I,2),T=F[0],U=F[1];function E(e,t){L(e?t:"")}s.a.useEffect((function(){Object(d.a)(l.a.mark((function t(){var a,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,O(!0),!(a=localStorage.getItem("token"))){t.next=8;break}return t.next=6,f.checkAndGet(a);case 6:(n=t.sent)&&(h(!0),r(n),e.push("/"));case 8:t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),h(!1),e.push("/signin");case 14:return t.prev=14,O(!1),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[0,10,14,17]])})))()}),[e]);var A=function(){var t=Object(d.a)(l.a.mark((function t(a,n){var s,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,k(!0),E(!0,"Signing In..."),t.next=5,f.signInUser({username:a,password:n});case 5:return s=t.sent,t.next=8,f.checkAndGet(s.token);case 8:c=t.sent,localStorage.setItem("token",s.token),r(c),h(!0),e.push("/"),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),U(Object(i.a)(Object(i.a)({},T),{},{isShown:!0,code:t.t0.status,type:"signin"}));case 18:return t.prev=18,k(!1),E(!1),t.finish(18);case 22:case"end":return t.stop()}}),t,null,[[0,15,18,22]])})));return function(e,a){return t.apply(this,arguments)}}(),M=function(){var t=Object(d.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),localStorage.clear(),h(!1),e.push("/");case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(g.jsx)("div",{className:"app",children:Object(g.jsx)("div",{className:"app__container",children:Object(g.jsxs)(j.d,{children:[Object(g.jsx)(x,{exact:!0,path:"/",isLoggedIn:u,isChecking:_,component:D,users:n,onSignOut:M}),Object(g.jsx)(j.b,{path:"/signin",children:Object(g.jsx)(V,{isSubmitting:N,buttonState:C,infoMessage:T,onSubmit:A})})]})})})},A=(a(48),function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,50)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,r=t.getLCP,c=t.getTTFB;a(e),n(e),s(e),r(e),c(e)}))});c.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(o.a,{children:Object(g.jsx)(E,{})})}),document.getElementById("root")),A()}},[[49,1,2]]]);
//# sourceMappingURL=main.a7891f70.chunk.js.map